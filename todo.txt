新状态: 
	.开局 x 秒 ~ y 秒为一个状态，能偷一刀是一刀(时间不好控制)
	50% or 75% 血量之后，增加攻击的频率，以期打崩架势条，代价是 boss 会有新的变招(基本上都可以处理了)。
	把 boss 的当前状态与之前的多个状态 cat 起来，形成新的状态[s_current, s_old_1, s_old_2 ...] => S 这样就相当于判断了 boss 的一套招式了
		状态空间为 [4, 4, 4] = 64
		把 player 的前一个动作也加入进去， 则状态空间为 [4, 4, 4, 8] = 512 
		每增加一个前状态或前动作，都会使得状态空间扩大为 4 倍。状态空间太大不好训练，太小了又没啥意义。

	player_hp 是否 < 60  可以做为状态，会使得状态空间扩大 2 倍
	boss_hp  是否 < 50 可以做为状态，会使得状态空间扩大 2 倍

	危是一个状态
		未危 0
		之前在防御 + 现在是擒拿危 1
		之前在进攻 + 现在是突刺危 2
		危的识别? 那么大的红色危，难道识别不出来？ 确实识别不出来。

	hp < 60 且 boss 被攻击命中
	player 被命中 x
	player hp down 位于 3 - 5 左右，此时是被踹到地上的


能读取到的数值: 
	player_hp
	boss_hp
	boss 架势条
		单纯防御不涨
		完美防御（弹刀）涨
		攻击无论是否造成伤害都会涨
		无需检测架势条，
			只需要在 boss_hp < 50 或 75 的时候，增加攻击动作的奖励即可。
			boss hp 也不必分段作为状态了(得做状态)
		

	出刀是否被 boss 防御 / 造成伤害
	player 架势条


如何弹刀？
	判断 boss 是否在发动招式
	防御成功的判断，此时可以松开鼠标

声音能做文章吗
	防御的时候有声音，完美防御声音更清脆
	蹬腿的动作有声音
	蓄力箭的动作有声音
	飞渡浮舟，如果一直在防御的话，有节奏的防御声
	突刺危的时候似乎有巨大的声音
	两连击的时候声音比较快速
	声音有滞后性，boss 招式都出来了，声音才出来..


一套招式的识别
	在录屏的时候我可以按下某个特殊键，用来标识一套招式。
	某些招式可以只识别招式的结尾， -- 2连击+五连击，结尾时可以补刀
	有些招式可以只识别招式的开始.  -- 突刺危，开始时可以识破
	帽子有时候会亮
	锁定白点的位置
		orig = image.copy()
		gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
		# 利用cv2.minMaxLoc寻找到图像中最亮和最暗的点
		(minVal, maxVal, minLoc, maxLoc) = cv2.minMaxLoc(gray)
		# 在图像中绘制结果，最亮的点有可能就是白点
		cv2.circle(image, maxLoc, 5, (255, 0, 0), 2)
		result = np.hstack([orig, image])
		cv2.imshow('result', result)
				

新招式：
	ATTACK + PARRY
	防御+攻击  是平A里面的第二招, 但需要发生在 boss 招式用到最后一节的时候，否则就会挨揍。
	贴身且 boss 举刀防御不动时可以尝试攻击

估算双方距离 

判断 boss 是否在攻击 

背景对于判定有影响
	有些位置的危能 predict 正确，有些位置就会 predict 错误.

录屏 
	区分为不同的招式起手
		突刺危
		擒拿危
		下段快速划动
		射箭
		两连击
		普通攻击
	防御或者被防御就不区分招式了, 此时会有火花
	区分为不同的硬直情况
		飞渡浮舟之后的硬直


将预测与 action 执行分为 2 个线程，这样预测出来的更加准确，不必等 action 执行完再进行截图和识别。

off-policy 也需要实现一遍


=================================================
攻击后，截屏判断是否命中（被防御时有高亮火花），若未命中则不 sleep.
录屏并抽取关键帧，分类，作为招式识别（注意在不同背景里面多录一些）
================================================

防御的时候按w+d键(可以加概率w+d/w+a/w)..有一定的效果

STAND_UP 有 bug， 如果前一个动作为 parry，STAND_UP也是is_parry，则会执行 IDLE。

何时发起普通攻击？
	首先必须在分类 0 里面
	架势条下降的时候，表示出现长时间空档，可以尝试发起，但不一定成功
	危解决(boss_hp down，但无法判断,也没关系，危如果处理不了后续几个动作都不会执行)之后，
		可以平a一次或多次。擒拿危3-4次， 突刺危 2 次，飞渡浮舟 2 次，连击不必等待 0.8 秒
	模型判断 boss 处于静止状态
	.连续2-4帧画面变化不大，可以认为是静止

把env运行时分类预测错误的图片放到0里面重新训练，效果会不会更好？



加上 boss 血条，探索连击次数
player hp 分段也加入，探索连击次数与喝血瓶的关系

# bad tuci 加到 4-5 个历史试一试, not work.

奖励函数里面判断一下 hp 下降的幅度，给予不同的奖励，可以提高4连击的分数

is_player_hp_down_slightly and is_player_hp_down can be two states.


